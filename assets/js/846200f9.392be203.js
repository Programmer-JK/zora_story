"use strict";(self.webpackChunkjk_story=self.webpackChunkjk_story||[]).push([[1440],{2074:(n,e,l)=>{l.r(e),l.d(e,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>d,toc:()=>t});var s=l(4848),i=l(8453);const c={},r=void 0,d={id:"DB/What is VACUUM",title:"What is VACUUM",description:"\uc791\uc131\uc77c : 2025.01.05",source:"@site/docs/05. DB/059903. What is VACUUM.md",sourceDirName:"05. DB",slug:"/DB/What is VACUUM",permalink:"/zora_story/docs/DB/What is VACUUM",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:59903,frontMatter:{},sidebar:"studySidebar",previous:{title:"Prisma CRUD \uc791\uc5c5 \uac00\uc774\ub4dc",permalink:"/zora_story/docs/DB/Prisma CRUD \uc791\uc5c5 \uac00\uc774\ub4dc"},next:{title:"DELETE Are Difficult",permalink:"/zora_story/docs/DB/DELETE Are Difficult"}},a={},t=[{value:"VACUUM\uc774\ub780?",id:"vacuum\uc774\ub780",level:2},{value:"VACUUM\uc774 \ud544\uc694\ud55c \uc774\uc720",id:"vacuum\uc774-\ud544\uc694\ud55c-\uc774\uc720",level:2},{value:"VACUUM\uc758 \uc791\ub3d9 \ubc29\uc2dd",id:"vacuum\uc758-\uc791\ub3d9-\ubc29\uc2dd",level:2},{value:"\uae30\ubcf8 VACUUM",id:"\uae30\ubcf8-vacuum",level:3},{value:"VACUUM FULL",id:"vacuum-full",level:3},{value:"ANALYZE",id:"analyze",level:3},{value:"AUTOVACUUM",id:"autovacuum",level:2},{value:"VACUUM \ubaa8\ub2c8\ud130\ub9c1",id:"vacuum-\ubaa8\ub2c8\ud130\ub9c1",level:2},{value:"\ubaa8\ubc94 \uc0ac\ub840",id:"\ubaa8\ubc94-\uc0ac\ub840",level:2},{value:"\uc694\uc57d",id:"\uc694\uc57d",level:2}];function u(n){const e={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"\uc791\uc131\uc77c : 2025.01.05"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"vacuum\uc774\ub780",children:"VACUUM\uc774\ub780?"}),"\n",(0,s.jsx)(e.p,{children:'VACUUM\uc740 PostgreSQL\uc758 \ud575\uc2ec \uc720\uc9c0\ubcf4\uc218 \uae30\ub2a5\uc73c\ub85c, \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc758 "\uc4f0\ub808\uae30"\ub97c \uc815\ub9ac\ud558\uace0 \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\ub294 \uc791\uc5c5\uc785\ub2c8\ub2e4.'}),"\n",(0,s.jsx)(e.h2,{id:"vacuum\uc774-\ud544\uc694\ud55c-\uc774\uc720",children:"VACUUM\uc774 \ud544\uc694\ud55c \uc774\uc720"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"MVCC(Multi-Version Concurrency Control) \ucc98\ub9ac"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"PostgreSQL\uc740 \ub370\uc774\ud130\ub97c \uc218\uc815/\uc0ad\uc81c\ud560 \ub54c \uae30\uc874 \ub370\uc774\ud130\ub97c \ubc14\ub85c \uc81c\uac70\ud558\uc9c0 \uc54a\uc74c"}),"\n",(0,s.jsx)(e.li,{children:"\ud2b8\ub79c\uc7ad\uc158\uc758 \ub3d9\uc2dc\uc131\uc744 \uc704\ud574 \uc5ec\ub7ec \ubc84\uc804\uc758 \ud589\uc744 \uc720\uc9c0"}),"\n",(0,s.jsx)(e.li,{children:'\uc774\ub85c \uc778\ud574 "\uc8fd\uc740 \ud29c\ud50c(dead tuples)"\uc774 \ubc1c\uc0dd'}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\ub514\uc2a4\ud06c \uacf5\uac04 \uad00\ub9ac"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"DELETE\ub41c \ub370\uc774\ud130\ub294 \uc2e4\uc81c\ub85c \ubc14\ub85c \uc0ad\uc81c\ub418\uc9c0 \uc54a\uc74c"}),"\n",(0,s.jsx)(e.li,{children:"UPDATE\ub41c \ub370\uc774\ud130\ub3c4 \uc0c8 \ubc84\uc804 \uc0dd\uc131"}),"\n",(0,s.jsx)(e.li,{children:"\uc774\ub7f0 \ub370\uc774\ud130\ub4e4\uc774 \ub514\uc2a4\ud06c \uacf5\uac04\uc744 \uacc4\uc18d \ucc28\uc9c0"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"vacuum\uc758-\uc791\ub3d9-\ubc29\uc2dd",children:"VACUUM\uc758 \uc791\ub3d9 \ubc29\uc2dd"}),"\n",(0,s.jsx)(e.h3,{id:"\uae30\ubcf8-vacuum",children:"\uae30\ubcf8 VACUUM"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"VACUUM my_table;\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\uc8fd\uc740 \ud29c\ud50c \uc2dd\ubcc4 \ubc0f \uc7ac\uc0ac\uc6a9 \uac00\ub2a5 \ud45c\uc2dc"}),"\n",(0,s.jsx)(e.li,{children:"\ub514\uc2a4\ud06c \uacf5\uac04\uc744 OS\uc5d0 \ubc18\ud658\ud558\uc9c0\ub294 \uc54a\uc74c"}),"\n",(0,s.jsx)(e.li,{children:"\ud14c\uc774\ube14 \uc811\uadfc \uc7a0\uae08 \uc5c6\uc774 \uc218\ud589 \uac00\ub2a5"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"vacuum-full",children:"VACUUM FULL"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"VACUUM FULL my_table;\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\ud14c\uc774\ube14\uc744 \uc644\uc804\ud788 \uc0c8\ub85c \uc791\uc131"}),"\n",(0,s.jsx)(e.li,{children:"\ub514\uc2a4\ud06c \uacf5\uac04\uc744 OS\uc5d0 \ubc18\ud658"}),"\n",(0,s.jsx)(e.li,{children:"\ud14c\uc774\ube14\uc5d0 \ub300\ud55c \ubc30\ud0c0\uc801 \uc7a0\uae08 \ud544\uc694"}),"\n",(0,s.jsx)(e.li,{children:"\ub354 \ub9ce\uc740 \uc2dc\uac04\uacfc \ub9ac\uc18c\uc2a4 \uc18c\uc694"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"analyze",children:"ANALYZE"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"VACUUM ANALYZE my_table;\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\ud14c\uc774\ube14\uc758 \ud1b5\uacc4 \uc815\ubcf4 \uc5c5\ub370\uc774\ud2b8"}),"\n",(0,s.jsx)(e.li,{children:"\ucffc\ub9ac \ud50c\ub798\ub108\uc758 \uc131\ub2a5 \ud5a5\uc0c1\uc5d0 \ub3c4\uc6c0"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"autovacuum",children:"AUTOVACUUM"}),"\n",(0,s.jsx)(e.p,{children:"PostgreSQL\uc740 \uc790\ub3d9\uc73c\ub85c VACUUM\uc744 \uc218\ud589\ud558\ub294 autovacuum \uae30\ub2a5\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- autovacuum \uc124\uc815 \ud655\uc778\nSHOW autovacuum_vacuum_threshold;\nSHOW autovacuum_vacuum_scale_factor;\n"})}),"\n",(0,s.jsx)(e.p,{children:"\uc8fc\uc694 \uc124\uc815:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"autovacuum_vacuum_threshold"}),": \ucd5c\uc18c \uc8fd\uc740 \ud29c\ud50c \uc218"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"autovacuum_vacuum_scale_factor"}),": \ud14c\uc774\ube14 \ud06c\uae30 \ub300\ube44 \ube44\uc728"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"autovacuum_vacuum_cost_limit"}),": \ub9ac\uc18c\uc2a4 \uc0ac\uc6a9\ub7c9 \uc81c\ud55c"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"vacuum-\ubaa8\ub2c8\ud130\ub9c1",children:"VACUUM \ubaa8\ub2c8\ud130\ub9c1"}),"\n",(0,s.jsx)(e.p,{children:"\ud604\uc7ac \uc0c1\ud0dc \ud655\uc778:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"SELECT relname, n_live_tup, n_dead_tup, last_vacuum\nFROM pg_stat_user_tables\nWHERE schemaname = 'public';\n"})}),"\n",(0,s.jsx)(e.p,{children:"bloat \ucd94\uc815:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"SELECT schemaname, tablename, \n       pg_size_pretty(bloat_size) as bloat_size,\n       round(bloat_ratio::numeric, 2) as bloat_ratio\nFROM pg_stats_pretty\nWHERE bloat_ratio > 30;\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\ubaa8\ubc94-\uc0ac\ub840",children:"\ubaa8\ubc94 \uc0ac\ub840"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\uc815\uae30\uc801\uc778 VACUUM \uc2e4\ud589"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"autovacuum \uc124\uc815 \ucd5c\uc801\ud654"}),"\n",(0,s.jsx)(e.li,{children:"\ub300\uaddc\ubaa8 DELETE/UPDATE \ud6c4 \uc218\ub3d9 VACUUM \uace0\ub824"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"VACUUM FULL \uc8fc\uc758\uc0ac\ud56d"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\uc720\uc9c0\ubcf4\uc218 \uc2dc\uac04\uc5d0 \uc2e4\ud589"}),"\n",(0,s.jsx)(e.li,{children:"\ucda9\ubd84\ud55c \ub514\uc2a4\ud06c \uacf5\uac04 \ud655\ubcf4"}),"\n",(0,s.jsx)(e.li,{children:"\ubc31\uc5c5 \uc900\ube44"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\ubaa8\ub2c8\ud130\ub9c1 \uc124\uc815"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\uc8fd\uc740 \ud29c\ud50c \uc218 \ucd94\uc801"}),"\n",(0,s.jsx)(e.li,{children:"bloat \uc218\uc900 \uad00\ucc30"}),"\n",(0,s.jsx)(e.li,{children:"VACUUM \ud65c\ub3d9 \ub85c\uae45"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\uc694\uc57d",children:"\uc694\uc57d"}),"\n",(0,s.jsx)(e.p,{children:"VACUUM\uc740 PostgreSQL\uc758 \uac74\uac15\ud55c \uc6b4\uc601\uc744 \uc704\ud55c \ud544\uc218 \uc791\uc5c5\uc785\ub2c8\ub2e4. \uc801\uc808\ud55c VACUUM \uc804\ub7b5\uc740 \ub2e4\uc74c\uc744 \ubcf4\uc7a5\ud569\ub2c8\ub2e4:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\ub514\uc2a4\ud06c \uacf5\uac04 \ud6a8\uc728\uc801 \uc0ac\uc6a9"}),"\n",(0,s.jsx)(e.li,{children:"\ucffc\ub9ac \uc131\ub2a5 \uc720\uc9c0"}),"\n",(0,s.jsx)(e.li,{children:"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc548\uc815\uc131 \ud655\ubcf4"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\ud6a8\uacfc\uc801\uc778 VACUUM \uad00\ub9ac\ub97c \uc704\ud574\uc11c\ub294 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc0ac\uc6a9 \ud328\ud134\uc744 \uc774\ud574\ud558\uace0, \uc801\uc808\ud55c \ubaa8\ub2c8\ud130\ub9c1\uacfc \uc720\uc9c0\ubcf4\uc218 \uacc4\ud68d\uc744 \uc218\ub9bd\ud558\ub294 \uac83\uc774 \uc911\uc694\ud569\ub2c8\ub2e4."})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(u,{...n})}):u(n)}},8453:(n,e,l)=>{l.d(e,{R:()=>r,x:()=>d});var s=l(6540);const i={},c=s.createContext(i);function r(n){const e=s.useContext(c);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),s.createElement(c.Provider,{value:e},n.children)}}}]);